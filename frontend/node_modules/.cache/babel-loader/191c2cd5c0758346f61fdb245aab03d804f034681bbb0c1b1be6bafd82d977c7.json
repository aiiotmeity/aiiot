{"ast":null,"code":"import React,{useEffect,useRef}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const LazyMap=_ref=>{let{userLocation,stations}=_ref;const mapRef=useRef(null);const mapInstanceRef=useRef(null);const markersRef=useRef({});const userMarkerRef=useRef(null);const getAQIColor=aqi=>{if(aqi===null||aqi===undefined)return'#6b7280';if(aqi<=50)return'#10b981';if(aqi<=100)return'#f59e0b';if(aqi<=200)return'#ef4444';return'#7c2d12';};const createAqiIcon=(aqi,name)=>{const color=getAQIColor(aqi);const iconHtml=`<div style=\"background-color: ${color};\" class=\"aqi-marker-icon\"><div class=\"aqi-marker-icon-inner\">${Math.round(aqi)||'N/A'}</div></div><div class=\"aqi-marker-label\">${name}</div>`;return window.L.divIcon({html:iconHtml,className:'custom-div-icon',iconSize:[40,40],iconAnchor:[20,40]});};useEffect(()=>{if(mapRef.current&&!mapInstanceRef.current){const map=window.L.map(mapRef.current,{zoomControl:false}).setView([10.176,76.430],13);window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);window.L.control.zoom({position:'topleft'}).addTo(map);mapInstanceRef.current=map;}},[]);useEffect(()=>{const map=mapInstanceRef.current;if(!map||!stations)return;Object.values(markersRef.current).forEach(marker=>marker.remove());markersRef.current={};Object.entries(stations).forEach(_ref2=>{let[id,station]=_ref2;const{lat,lng,name}=station.station_info;const marker=window.L.marker([lat,lng],{icon:createAqiIcon(station.highest_sub_index,name)}).addTo(map);markersRef.current[id]=marker;});},[stations]);useEffect(()=>{const map=mapInstanceRef.current;if(map&&userLocation){map.setView([userLocation.lat,userLocation.lng],14);if(userMarkerRef.current){userMarkerRef.current.setLatLng([userLocation.lat,userLocation.lng]);}else{userMarkerRef.current=window.L.marker([userLocation.lat,userLocation.lng]).addTo(map);}}},[userLocation]);return/*#__PURE__*/_jsx(\"div\",{ref:mapRef,style:{height:'100%',width:'100%',borderRadius:'12px'}});};export default LazyMap;","map":{"version":3,"names":["React","useEffect","useRef","jsx","_jsx","LazyMap","_ref","userLocation","stations","mapRef","mapInstanceRef","markersRef","userMarkerRef","getAQIColor","aqi","undefined","createAqiIcon","name","color","iconHtml","Math","round","window","L","divIcon","html","className","iconSize","iconAnchor","current","map","zoomControl","setView","tileLayer","addTo","control","zoom","position","Object","values","forEach","marker","remove","entries","_ref2","id","station","lat","lng","station_info","icon","highest_sub_index","setLatLng","ref","style","height","width","borderRadius"],"sources":["C:/React/my-django-react-app/frontend/src/components/LazyMap.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\n\r\nconst LazyMap = ({ userLocation, stations }) => {\r\n    const mapRef = useRef(null);\r\n    const mapInstanceRef = useRef(null);\r\n    const markersRef = useRef({});\r\n    const userMarkerRef = useRef(null);\r\n\r\n    const getAQIColor = (aqi) => {\r\n        if (aqi === null || aqi === undefined) return '#6b7280';\r\n        if (aqi <= 50) return '#10b981';\r\n        if (aqi <= 100) return '#f59e0b';\r\n        if (aqi <= 200) return '#ef4444';\r\n        return '#7c2d12';\r\n    };\r\n    const createAqiIcon = (aqi, name) => {\r\n        const color = getAQIColor(aqi);\r\n        const iconHtml = `<div style=\"background-color: ${color};\" class=\"aqi-marker-icon\"><div class=\"aqi-marker-icon-inner\">${Math.round(aqi) || 'N/A'}</div></div><div class=\"aqi-marker-label\">${name}</div>`;\r\n        return window.L.divIcon({ html: iconHtml, className: 'custom-div-icon', iconSize: [40, 40], iconAnchor: [20, 40] });\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (mapRef.current && !mapInstanceRef.current) {\r\n            const map = window.L.map(mapRef.current, { zoomControl: false }).setView([10.176, 76.430], 13);\r\n            window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\r\n            window.L.control.zoom({ position: 'topleft' }).addTo(map);\r\n            mapInstanceRef.current = map;\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const map = mapInstanceRef.current;\r\n        if (!map || !stations) return;\r\n\r\n        Object.values(markersRef.current).forEach(marker => marker.remove());\r\n        markersRef.current = {};\r\n\r\n        Object.entries(stations).forEach(([id, station]) => {\r\n            const { lat, lng, name } = station.station_info;\r\n            const marker = window.L.marker([lat, lng], { icon: createAqiIcon(station.highest_sub_index, name) }).addTo(map);\r\n            markersRef.current[id] = marker;\r\n        });\r\n\r\n    }, [stations]);\r\n    \r\n    useEffect(() => {\r\n        const map = mapInstanceRef.current;\r\n        if (map && userLocation) {\r\n            map.setView([userLocation.lat, userLocation.lng], 14);\r\n            if (userMarkerRef.current) {\r\n                userMarkerRef.current.setLatLng([userLocation.lat, userLocation.lng]);\r\n            } else {\r\n                userMarkerRef.current = window.L.marker([userLocation.lat, userLocation.lng]).addTo(map);\r\n            }\r\n        }\r\n    }, [userLocation]);\r\n\r\n    return <div ref={mapRef} style={{ height: '100%', width: '100%', borderRadius: '12px' }}></div>;\r\n};\r\n\r\nexport default LazyMap;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}