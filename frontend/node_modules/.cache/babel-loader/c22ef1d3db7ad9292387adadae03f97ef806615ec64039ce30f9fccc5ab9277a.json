{"ast":null,"code":"var _jsxFileName = \"C:\\\\React\\\\my-django-react-app\\\\frontend\\\\src\\\\components\\\\MapPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport logoImage from '../assets/aqi.webp';\nimport { useAuth } from '../App';\nimport './css/MapPage.css';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler } from 'chart.js';\nimport { Line } from 'react-chartjs-2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler);\n\n// --- Helper Functions ---\nconst getAQIColor = aqi => {\n  if (aqi === null || aqi === undefined) return '#9ca3af';\n  if (aqi <= 50) return '#10b981';\n  if (aqi <= 100) return '#f59e0b';\n  if (aqi <= 200) return '#ef4444';\n  return '#7c2d12';\n};\nconst getAQIStatus = aqi => {\n  if (aqi === null || aqi === undefined) return 'Unknown';\n  if (aqi <= 50) return 'Good';\n  if (aqi <= 100) return 'Moderate';\n  if (aqi <= 200) return 'Unhealthy';\n  return 'Hazardous';\n};\nconst calculateDistance = (lat1, lon1, lat2, lon2) => {\n  const R = 6371; // km\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = Math.sin(dLat / 2) ** 2 + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) ** 2;\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n};\nconst MapPage = () => {\n  _s();\n  const [mapInstance, setMapInstance] = useState(null);\n  const [stations, setStations] = useState({});\n  const [selectedStationId, setSelectedStationId] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [userLocation, setUserLocation] = useState(null);\n  const [userLocationData, setUserLocationData] = useState(null);\n  const [isLocationLoading, setIsLocationLoading] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);\n  const [isPanelOpen, setIsPanelOpen] = useState(false);\n  const [activeTab, setActiveTab] = useState('stations'); // Default to stations for logged-out users\n  const [forecastData, setForecastData] = useState([]);\n  const [isForecastLoading, setIsForecastLoading] = useState(false);\n  const mapRef = useRef(null);\n  const markersRef = useRef({});\n  const userLocationMarkerRef = useRef(null);\n  const {\n    user,\n    logout\n  } = useAuth();\n  const navigate = useNavigate();\n  const API_BASE_URL = process.env.NODE_ENV === 'production' ? 'https://airaware-app-gcw7.onrender.com' : 'http://localhost:8000';\n\n  // **FIX 1: PAGE-LEVEL SECURITY CHECK REMOVED**\n  // The useEffect that redirected if !user is now gone.\n\n  useEffect(() => {\n    const handleResize = () => setIsMobile(window.innerWidth <= 768);\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  useEffect(() => {\n    if (mapRef.current && !mapRef.current._leaflet_id) {\n      const map = window.L.map(mapRef.current, {\n        zoomControl: false\n      }).setView([10.176, 76.430], 13);\n      window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '© OpenStreetMap'\n      }).addTo(map);\n      window.L.control.zoom({\n        position: 'topright'\n      }).addTo(map);\n      setMapInstance(map);\n    }\n  }, []);\n  const calculateSmartEstimation = useCallback((locationData, allStations) => {\n    const realStations = Object.values(allStations).filter(s => s.averages);\n    if (realStations.length === 0) return {\n      aqi: 0,\n      values: {}\n    };\n    let totalWeight = 0,\n      weightedAqi = 0;\n    const weightedValues = {\n      pm25: 0,\n      pm10: 0,\n      so2: 0,\n      no2: 0,\n      co: 0,\n      o3: 0,\n      nh3: 0\n    };\n    realStations.forEach(station => {\n      const distance = calculateDistance(locationData.lat, locationData.lng, station.station_info.lat, station.station_info.lng);\n      const weight = 1.0 / Math.max(distance, 0.001) ** 2;\n      totalWeight += weight;\n      Object.keys(weightedValues).forEach(param => {\n        var _station$averages;\n        if (((_station$averages = station.averages) === null || _station$averages === void 0 ? void 0 : _station$averages[param]) !== undefined) weightedValues[param] += station.averages[param] * weight;\n      });\n      weightedAqi += (station.highest_sub_index || 0) * weight;\n    });\n    const estimatedValues = {};\n    Object.keys(weightedValues).forEach(param => {\n      estimatedValues[param] = totalWeight > 0 ? parseFloat((weightedValues[param] / totalWeight).toFixed(2)) : 0;\n    });\n    const estimatedAqi = totalWeight > 0 ? Math.round(weightedAqi / totalWeight) : 50;\n    return {\n      values: estimatedValues,\n      aqi: estimatedAqi\n    };\n  }, []);\n  useEffect(() => {\n    if (userLocation && Object.keys(stations).length > 0) {\n      const estimation = calculateSmartEstimation(userLocation, stations);\n      const {\n        lat,\n        lng\n      } = stations['lora-v1'].station_info;\n      const distanceToNearest = calculateDistance(userLocation.lat, userLocation.lng, lat, lng);\n      setUserLocationData({\n        aqi: estimation.aqi,\n        values: estimation.values,\n        quality: distanceToNearest <= 5.0 ? 'High-Accuracy' : 'Regional Estimation'\n      });\n    }\n  }, [userLocation, stations, calculateSmartEstimation]);\n  useEffect(() => {\n    const fetchData = async () => {\n      setIsLoading(true);\n      try {\n        const response = await fetch(`${API_BASE_URL}/api/map/realtime/`);\n        if (!response.ok) throw new Error('Network response was not ok');\n        const data = await response.json();\n        setStations(data.stations);\n      } catch (err) {\n        console.error(\"Failed to fetch station data:\", err);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchData();\n    const interval = setInterval(fetchData, 60000);\n    return () => clearInterval(interval);\n  }, [API_BASE_URL]);\n  useEffect(() => {\n    if (!selectedStationId) return;\n    const fetchForecast = async () => {\n      setIsForecastLoading(true);\n      try {\n        const response = await fetch(`${API_BASE_URL}/api/station/${selectedStationId}/forecast/`);\n        const data = await response.json();\n        setForecastData(data.forecast_data || []);\n      } catch (err) {\n        setForecastData([]);\n      } finally {\n        setIsForecastLoading(false);\n      }\n    };\n    fetchForecast();\n  }, [selectedStationId, API_BASE_URL]);\n  useEffect(() => {\n    if (mapInstance && Object.keys(stations).length > 0) {\n      Object.values(markersRef.current).forEach(marker => marker.remove());\n      markersRef.current = {};\n      Object.entries(stations).forEach(([id, station]) => {\n        const {\n          lat,\n          lng\n        } = station.station_info;\n        const icon = window.L.divIcon({\n          html: `<div class=\"station-marker-icon\" style=\"background-color: ${getAQIColor(station.highest_sub_index)};\"></div>`,\n          className: 'station-marker'\n        });\n        const marker = window.L.marker([lat, lng], {\n          icon\n        }).addTo(mapInstance);\n        marker.on('click', () => {\n          setSelectedStationId(id);\n          if (isMobile) {\n            setActiveTab('forecast');\n            setIsPanelOpen(true);\n          }\n        });\n        markersRef.current[id] = marker;\n      });\n    }\n  }, [mapInstance, stations, isMobile]);\n  useEffect(() => {\n    if (mapInstance && userLocation) {\n      const userIcon = window.L.divIcon({\n        html: `<div class=\"user-location-marker\"></div>`,\n        className: 'user-marker'\n      });\n      if (userLocationMarkerRef.current) {\n        userLocationMarkerRef.current.setLatLng(userLocation);\n      } else {\n        userLocationMarkerRef.current = window.L.marker(userLocation, {\n          icon: userIcon\n        }).addTo(mapInstance);\n      }\n    }\n  }, [mapInstance, userLocation]);\n\n  // **FIX 2: SECURITY CHECK MOVED INSIDE THE BUTTON'S FUNCTION**\n  const trackUserLocation = useCallback(() => {\n    if (user) {\n      // If user is logged in, track their location\n      setIsLocationLoading(true);\n      navigator.geolocation.getCurrentPosition(position => {\n        const loc = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n        setUserLocation(loc);\n        setIsLocationLoading(false);\n        if (mapInstance) mapInstance.setView(loc, 15);\n        if (isMobile) {\n          setActiveTab('user');\n          setIsPanelOpen(true);\n        }\n      }, () => setIsLocationLoading(false), {\n        enableHighAccuracy: true\n      });\n    } else {\n      // If user is NOT logged in, redirect to login page\n      navigate('/login');\n    }\n  }, [mapInstance, isMobile, user, navigate]);\n  const renderUserContent = () => {\n    if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-login-prompt\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-lock\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Personalized Data is Secure\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Log in to track your location and get air quality data specific to you.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/login\",\n        className: \"mobile-login-btn\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-sign-in-alt\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }, this), \" Login to View\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 13\n    }, this);\n    if (isLocationLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-loader\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 70\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Finding Your Location...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 109\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 39\n    }, this);\n    if (!userLocationData) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-location-prompt\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-map-marker-alt\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Find Your Local Air Quality\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Get personalized air quality data for your current location.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"mobile-location-btn\",\n        onClick: trackUserLocation,\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-crosshairs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 21\n        }, this), \" Use My Location\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 13\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-user-aqi\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-aqi-circle\",\n        style: {\n          background: getAQIColor(userLocationData.aqi)\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aqi-number\",\n          children: Math.round(userLocationData.aqi)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aqi-label\",\n          children: getAQIStatus(userLocationData.aqi)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-location-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [userLocationData.quality, \" Data\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"This is an estimated air quality for your current location, calculated using our real sensor network.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }, this);\n  };\n  const renderStationContent = () => {\n    if (isLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-loader\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 62\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading Stations...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 101\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 31\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-station-list\",\n      children: Object.entries(stations).map(([id, station]) => /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `mobile-station-card ${selectedStationId === id ? 'active' : ''}`,\n        onClick: () => {\n          setSelectedStationId(id);\n          setActiveTab('forecast');\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"station-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: station.station_info.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"station-meta\",\n            children: \"Real-time Sensor\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"station-aqi-badge\",\n          style: {\n            backgroundColor: getAQIColor(station.highest_sub_index)\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"aqi-number\",\n            children: Math.round(station.highest_sub_index)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"aqi-status\",\n            children: getAQIStatus(station.highest_sub_index)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 25\n        }, this)]\n      }, id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 13\n    }, this);\n  };\n  const renderForecastContent = () => {\n    var _stations$selectedSta;\n    if (!selectedStationId) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-no-selection\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-chart-line\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"No Station Selected\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Please select a station from the list to view its forecast.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"select-station-btn\",\n        onClick: () => setActiveTab('stations'),\n        children: \"Select a Station\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 14\n    }, this);\n    if (isForecastLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-loader\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 70\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading Forecast...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 109\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 39\n    }, this);\n    const chartData = {\n      labels: forecastData.map(d => new Date(d.day).toLocaleDateString('en-US', {\n        weekday: 'short'\n      })),\n      datasets: [{\n        label: 'AQI Forecast',\n        data: forecastData.map(d => d.pm25_max),\n        borderColor: '#3b82f6',\n        backgroundColor: 'rgba(59, 130, 246, 0.1)',\n        fill: true,\n        tension: 0.4\n      }]\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mobile-forecast-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-section-header\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-chart-line\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 25\n          }, this), \" \", (_stations$selectedSta = stations[selectedStationId]) === null || _stations$selectedSta === void 0 ? void 0 : _stations$selectedSta.station_info.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mobile-chart-container\",\n        children: /*#__PURE__*/_jsxDEV(Line, {\n          data: chartData,\n          options: {\n            responsive: true,\n            maintainAspectRatio: false\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 13\n    }, this);\n  };\n  const renderPanelForDesktop = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"data-panel\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"data-panel-content\",\n      children: [renderUserContent(), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"station-list-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-broadcast-tower\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 51\n          }, this), \" Monitoring Stations\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"station-selector\",\n          children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-spinner small\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 38\n          }, this) : Object.entries(stations).map(([id, station]) => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `station-btn ${selectedStationId === id ? 'active' : ''}`,\n            onClick: () => setSelectedStationId(id),\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"station-name\",\n              children: station.station_info.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"station-aqi\",\n              style: {\n                backgroundColor: getAQIColor(station.highest_sub_index)\n              },\n              children: Math.round(station.highest_sub_index)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 33\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 306,\n    columnNumber: 10\n  }, this);\n  const renderDetailsPanelForDesktop = () => {\n    if (!selectedStationId) return null;\n    const station = stations[selectedStationId];\n    if (!station) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"station-details-panel\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"station-details-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"station-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: station.station_info.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n      className: \"navbar\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"navbar-content\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          className: \"navbar-brand\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: logoImage,\n            alt: \"AQM Logo\",\n            width: isMobile ? \"28\" : \"32\",\n            height: isMobile ? \"28\" : \"32\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"AirAware\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"nav-right\",\n          children: user ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-menu\",\n            children: [/*#__PURE__*/_jsxDEV(Link, {\n              to: \"/dashboard\",\n              className: \"nav-link\",\n              children: \"Dashboard\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: logout,\n              className: \"logout-btn\",\n              children: \"Logout\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/login\",\n            className: \"login-btn\",\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"map\",\n          ref: mapRef,\n          className: \"map-element\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: trackUserLocation,\n          className: `my-location-btn ${isLocationLoading ? 'loading' : ''}`,\n          disabled: isLocationLoading,\n          children: isLocationLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-spinner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 46\n          }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-crosshairs\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 88\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 21\n        }, this), isMobile && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"mobile-menu-toggle\",\n          onClick: () => setIsPanelOpen(!isPanelOpen),\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: `fas ${isPanelOpen ? 'fa-times' : 'fa-bars'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 17\n      }, this), !isMobile && renderPanelForDesktop(), !isMobile && renderDetailsPanelForDesktop(), isMobile && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `mobile-bottom-sheet ${isPanelOpen ? 'open' : ''}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mobile-tab-nav\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `mobile-tab-btn ${activeTab === 'user' ? 'active' : ''}`,\n            onClick: () => setActiveTab('user'),\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-user-circle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 33\n            }, this), \" Your Location\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `mobile-tab-btn ${activeTab === 'stations' ? 'active' : ''}`,\n            onClick: () => setActiveTab('stations'),\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-broadcast-tower\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 33\n            }, this), \" Stations\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `mobile-tab-btn ${activeTab === 'forecast' ? 'active' : ''}`,\n            onClick: () => setActiveTab('forecast'),\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-chart-line\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 33\n            }, this), \" Forecast\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mobile-tab-content-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mobile-tab-content\",\n            children: [activeTab === 'user' && renderUserContent(), activeTab === 'stations' && renderStationContent(), activeTab === 'forecast' && renderForecastContent()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 344,\n    columnNumber: 9\n  }, this);\n};\n_s(MapPage, \"E9Ujl6rvR8ciE+VvlCUAqmV7VEo=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = MapPage;\nexport default MapPage;\nvar _c;\n$RefreshReg$(_c, \"MapPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Link","useNavigate","logoImage","useAuth","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","Filler","Line","jsxDEV","_jsxDEV","register","getAQIColor","aqi","undefined","getAQIStatus","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","Math","PI","dLon","a","sin","cos","c","atan2","sqrt","MapPage","_s","mapInstance","setMapInstance","stations","setStations","selectedStationId","setSelectedStationId","isLoading","setIsLoading","userLocation","setUserLocation","userLocationData","setUserLocationData","isLocationLoading","setIsLocationLoading","isMobile","setIsMobile","window","innerWidth","isPanelOpen","setIsPanelOpen","activeTab","setActiveTab","forecastData","setForecastData","isForecastLoading","setIsForecastLoading","mapRef","markersRef","userLocationMarkerRef","user","logout","navigate","API_BASE_URL","process","env","NODE_ENV","handleResize","addEventListener","removeEventListener","current","_leaflet_id","map","L","zoomControl","setView","tileLayer","attribution","addTo","control","zoom","position","calculateSmartEstimation","locationData","allStations","realStations","Object","values","filter","s","averages","length","totalWeight","weightedAqi","weightedValues","pm25","pm10","so2","no2","co","o3","nh3","forEach","station","distance","lat","lng","station_info","weight","max","keys","param","_station$averages","highest_sub_index","estimatedValues","parseFloat","toFixed","estimatedAqi","round","estimation","distanceToNearest","quality","fetchData","response","fetch","ok","Error","data","json","err","console","error","interval","setInterval","clearInterval","fetchForecast","forecast_data","marker","remove","entries","id","icon","divIcon","html","className","on","userIcon","setLatLng","trackUserLocation","navigator","geolocation","getCurrentPosition","loc","coords","latitude","longitude","enableHighAccuracy","renderUserContent","children","fileName","_jsxFileName","lineNumber","columnNumber","to","onClick","style","background","renderStationContent","name","backgroundColor","renderForecastContent","_stations$selectedSta","chartData","labels","d","Date","day","toLocaleDateString","weekday","datasets","label","pm25_max","borderColor","fill","tension","options","responsive","maintainAspectRatio","renderPanelForDesktop","renderDetailsPanelForDesktop","src","alt","width","height","ref","disabled","_c","$RefreshReg$"],"sources":["C:/React/my-django-react-app/frontend/src/components/MapPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport logoImage from '../assets/aqi.webp'; \r\nimport { useAuth } from '../App';\r\nimport './css/MapPage.css';\r\nimport {\r\n  Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler\r\n} from 'chart.js';\r\nimport { Line } from 'react-chartjs-2';\r\n\r\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler);\r\n\r\n// --- Helper Functions ---\r\nconst getAQIColor = (aqi) => {\r\n    if (aqi === null || aqi === undefined) return '#9ca3af';\r\n    if (aqi <= 50) return '#10b981';\r\n    if (aqi <= 100) return '#f59e0b';\r\n    if (aqi <= 200) return '#ef4444';\r\n    return '#7c2d12';\r\n};\r\n\r\nconst getAQIStatus = (aqi) => {\r\n    if (aqi === null || aqi === undefined) return 'Unknown';\r\n    if (aqi <= 50) return 'Good';\r\n    if (aqi <= 100) return 'Moderate';\r\n    if (aqi <= 200) return 'Unhealthy';\r\n    return 'Hazardous';\r\n};\r\n\r\nconst calculateDistance = (lat1, lon1, lat2, lon2) => {\r\n    const R = 6371; // km\r\n    const dLat = (lat2 - lat1) * Math.PI / 180;\r\n    const dLon = (lon2 - lon1) * Math.PI / 180;\r\n    const a = Math.sin(dLat / 2) ** 2 + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) ** 2;\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    return R * c;\r\n};\r\n\r\nconst MapPage = () => {\r\n    const [mapInstance, setMapInstance] = useState(null);\r\n    const [stations, setStations] = useState({});\r\n    const [selectedStationId, setSelectedStationId] = useState(null);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [userLocation, setUserLocation] = useState(null);\r\n    const [userLocationData, setUserLocationData] = useState(null);\r\n    const [isLocationLoading, setIsLocationLoading] = useState(false);\r\n    const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);\r\n    const [isPanelOpen, setIsPanelOpen] = useState(false);\r\n    const [activeTab, setActiveTab] = useState('stations'); // Default to stations for logged-out users\r\n    const [forecastData, setForecastData] = useState([]);\r\n    const [isForecastLoading, setIsForecastLoading] = useState(false);\r\n\r\n    const mapRef = useRef(null);\r\n    const markersRef = useRef({});\r\n    const userLocationMarkerRef = useRef(null);\r\n    const { user, logout } = useAuth();\r\n    const navigate = useNavigate();\r\n    const API_BASE_URL = process.env.NODE_ENV === 'production' \r\n        ? 'https://airaware-app-gcw7.onrender.com' \r\n        : 'http://localhost:8000';\r\n\r\n    // **FIX 1: PAGE-LEVEL SECURITY CHECK REMOVED**\r\n    // The useEffect that redirected if !user is now gone.\r\n\r\n    useEffect(() => {\r\n        const handleResize = () => setIsMobile(window.innerWidth <= 768);\r\n        window.addEventListener('resize', handleResize);\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (mapRef.current && !mapRef.current._leaflet_id) {\r\n            const map = window.L.map(mapRef.current, { zoomControl: false }).setView([10.176, 76.430], 13);\r\n            window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '© OpenStreetMap' }).addTo(map);\r\n            window.L.control.zoom({ position: 'topright' }).addTo(map);\r\n            setMapInstance(map);\r\n        }\r\n    }, []);\r\n\r\n    const calculateSmartEstimation = useCallback((locationData, allStations) => {\r\n        const realStations = Object.values(allStations).filter(s => s.averages);\r\n        if (realStations.length === 0) return { aqi: 0, values: {} };\r\n        let totalWeight = 0, weightedAqi = 0;\r\n        const weightedValues = { pm25: 0, pm10: 0, so2: 0, no2: 0, co: 0, o3: 0, nh3: 0 };\r\n        realStations.forEach(station => {\r\n            const distance = calculateDistance(locationData.lat, locationData.lng, station.station_info.lat, station.station_info.lng);\r\n            const weight = 1.0 / (Math.max(distance, 0.001) ** 2);\r\n            totalWeight += weight;\r\n            Object.keys(weightedValues).forEach(param => {\r\n                if (station.averages?.[param] !== undefined) weightedValues[param] += station.averages[param] * weight;\r\n            });\r\n            weightedAqi += (station.highest_sub_index || 0) * weight;\r\n        });\r\n        const estimatedValues = {};\r\n        Object.keys(weightedValues).forEach(param => {\r\n            estimatedValues[param] = totalWeight > 0 ? parseFloat((weightedValues[param] / totalWeight).toFixed(2)) : 0;\r\n        });\r\n        const estimatedAqi = totalWeight > 0 ? Math.round(weightedAqi / totalWeight) : 50;\r\n        return { values: estimatedValues, aqi: estimatedAqi };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (userLocation && Object.keys(stations).length > 0) {\r\n            const estimation = calculateSmartEstimation(userLocation, stations);\r\n            const { lat, lng } = stations['lora-v1'].station_info;\r\n            const distanceToNearest = calculateDistance(userLocation.lat, userLocation.lng, lat, lng);\r\n            setUserLocationData({\r\n                aqi: estimation.aqi,\r\n                values: estimation.values,\r\n                quality: distanceToNearest <= 5.0 ? 'High-Accuracy' : 'Regional Estimation'\r\n            });\r\n        }\r\n    }, [userLocation, stations, calculateSmartEstimation]);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            setIsLoading(true);\r\n            try {\r\n                const response = await fetch(`${API_BASE_URL}/api/map/realtime/`);\r\n                if (!response.ok) throw new Error('Network response was not ok');\r\n                const data = await response.json();\r\n                setStations(data.stations);\r\n            } catch (err) {\r\n                console.error(\"Failed to fetch station data:\", err);\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n        fetchData();\r\n        const interval = setInterval(fetchData, 60000);\r\n        return () => clearInterval(interval);\r\n    }, [API_BASE_URL]);\r\n\r\n    useEffect(() => {\r\n        if (!selectedStationId) return;\r\n        const fetchForecast = async () => {\r\n            setIsForecastLoading(true);\r\n            try {\r\n                const response = await fetch(`${API_BASE_URL}/api/station/${selectedStationId}/forecast/`);\r\n                const data = await response.json();\r\n                setForecastData(data.forecast_data || []);\r\n            } catch (err) {\r\n                setForecastData([]);\r\n            } finally {\r\n                setIsForecastLoading(false);\r\n            }\r\n        };\r\n        fetchForecast();\r\n    }, [selectedStationId, API_BASE_URL]);\r\n\r\n    useEffect(() => {\r\n        if (mapInstance && Object.keys(stations).length > 0) {\r\n            Object.values(markersRef.current).forEach(marker => marker.remove());\r\n            markersRef.current = {};\r\n            Object.entries(stations).forEach(([id, station]) => {\r\n                const { lat, lng } = station.station_info;\r\n                const icon = window.L.divIcon({\r\n                    html: `<div class=\"station-marker-icon\" style=\"background-color: ${getAQIColor(station.highest_sub_index)};\"></div>`,\r\n                    className: 'station-marker',\r\n                });\r\n                const marker = window.L.marker([lat, lng], { icon }).addTo(mapInstance);\r\n                marker.on('click', () => {\r\n                    setSelectedStationId(id);\r\n                    if (isMobile) {\r\n                        setActiveTab('forecast');\r\n                        setIsPanelOpen(true);\r\n                    }\r\n                });\r\n                markersRef.current[id] = marker;\r\n            });\r\n        }\r\n    }, [mapInstance, stations, isMobile]);\r\n    \r\n    useEffect(() => {\r\n        if (mapInstance && userLocation) {\r\n            const userIcon = window.L.divIcon({\r\n                html: `<div class=\"user-location-marker\"></div>`,\r\n                className: 'user-marker',\r\n            });\r\n            if (userLocationMarkerRef.current) {\r\n                userLocationMarkerRef.current.setLatLng(userLocation);\r\n            } else {\r\n                userLocationMarkerRef.current = window.L.marker(userLocation, { icon: userIcon }).addTo(mapInstance);\r\n            }\r\n        }\r\n    }, [mapInstance, userLocation]);\r\n\r\n    // **FIX 2: SECURITY CHECK MOVED INSIDE THE BUTTON'S FUNCTION**\r\n    const trackUserLocation = useCallback(() => {\r\n        if (user) {\r\n            // If user is logged in, track their location\r\n            setIsLocationLoading(true);\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    const loc = { lat: position.coords.latitude, lng: position.coords.longitude };\r\n                    setUserLocation(loc);\r\n                    setIsLocationLoading(false);\r\n                    if (mapInstance) mapInstance.setView(loc, 15);\r\n                    if (isMobile) {\r\n                        setActiveTab('user');\r\n                        setIsPanelOpen(true);\r\n                    }\r\n                },\r\n                () => setIsLocationLoading(false),\r\n                { enableHighAccuracy: true }\r\n            );\r\n        } else {\r\n            // If user is NOT logged in, redirect to login page\r\n            navigate('/login');\r\n        }\r\n    }, [mapInstance, isMobile, user, navigate]);\r\n    \r\n    const renderUserContent = () => {\r\n        if (!user) return (\r\n            <div className=\"mobile-login-prompt\">\r\n                <i className=\"fas fa-lock\"></i>\r\n                <h4>Personalized Data is Secure</h4>\r\n                <p>Log in to track your location and get air quality data specific to you.</p>\r\n                <Link to=\"/login\" className=\"mobile-login-btn\">\r\n                    <i className=\"fas fa-sign-in-alt\"></i> Login to View\r\n                </Link>\r\n            </div>\r\n        );\r\n        if (isLocationLoading) return <div className=\"mobile-loader\"><div className=\"loading-spinner\"></div><p>Finding Your Location...</p></div>;\r\n        if (!userLocationData) return (\r\n            <div className=\"mobile-location-prompt\">\r\n                <i className=\"fas fa-map-marker-alt\"></i>\r\n                <h4>Find Your Local Air Quality</h4>\r\n                <p>Get personalized air quality data for your current location.</p>\r\n                <button className=\"mobile-location-btn\" onClick={trackUserLocation}>\r\n                    <i className=\"fas fa-crosshairs\"></i> Use My Location\r\n                </button>\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div className=\"mobile-user-aqi\">\r\n                <div className=\"user-aqi-circle\" style={{ background: getAQIColor(userLocationData.aqi) }}>\r\n                    <div className=\"aqi-number\">{Math.round(userLocationData.aqi)}</div>\r\n                    <div className=\"aqi-label\">{getAQIStatus(userLocationData.aqi)}</div>\r\n                </div>\r\n                <div className=\"user-location-info\">\r\n                    <h4>{userLocationData.quality} Data</h4>\r\n                    <p>This is an estimated air quality for your current location, calculated using our real sensor network.</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderStationContent = () => {\r\n        if (isLoading) return <div className=\"mobile-loader\"><div className=\"loading-spinner\"></div><p>Loading Stations...</p></div>;\r\n        return (\r\n            <div className=\"mobile-station-list\">\r\n                {Object.entries(stations).map(([id, station]) => (\r\n                    <button key={id} className={`mobile-station-card ${selectedStationId === id ? 'active' : ''}`} onClick={() => { setSelectedStationId(id); setActiveTab('forecast'); }}>\r\n                        <div className=\"station-info\">\r\n                            <h4>{station.station_info.name}</h4>\r\n                            <span className=\"station-meta\">Real-time Sensor</span>\r\n                        </div>\r\n                        <div className=\"station-aqi-badge\" style={{ backgroundColor: getAQIColor(station.highest_sub_index) }}>\r\n                            <span className=\"aqi-number\">{Math.round(station.highest_sub_index)}</span>\r\n                            <span className=\"aqi-status\">{getAQIStatus(station.highest_sub_index)}</span>\r\n                        </div>\r\n                    </button>\r\n                ))}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderForecastContent = () => {\r\n        if (!selectedStationId) return (\r\n             <div className=\"mobile-no-selection\">\r\n                <i className=\"fas fa-chart-line\"></i>\r\n                <h3>No Station Selected</h3>\r\n                <p>Please select a station from the list to view its forecast.</p>\r\n                 <button className=\"select-station-btn\" onClick={() => setActiveTab('stations')}>Select a Station</button>\r\n            </div>\r\n        );\r\n        if (isForecastLoading) return <div className=\"mobile-loader\"><div className=\"loading-spinner\"></div><p>Loading Forecast...</p></div>;\r\n        \r\n        const chartData = {\r\n            labels: forecastData.map(d => new Date(d.day).toLocaleDateString('en-US', { weekday: 'short' })),\r\n            datasets: [{\r\n                label: 'AQI Forecast',\r\n                data: forecastData.map(d => d.pm25_max),\r\n                borderColor: '#3b82f6',\r\n                backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n                fill: true,\r\n                tension: 0.4\r\n            }]\r\n        };\r\n        \r\n        return (\r\n            <div className=\"mobile-forecast-section\">\r\n                <div className=\"mobile-section-header\">\r\n                    <h3><i className=\"fas fa-chart-line\"></i> {stations[selectedStationId]?.station_info.name}</h3>\r\n                </div>\r\n                <div className=\"mobile-chart-container\">\r\n                    <Line data={chartData} options={{ responsive: true, maintainAspectRatio: false }} />\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderPanelForDesktop = () => (\r\n         <div className=\"data-panel\">\r\n            <div className=\"data-panel-content\">\r\n                {renderUserContent()}\r\n                <div className=\"station-list-section\">\r\n                    <h2 className=\"section-title\"><i className=\"fas fa-broadcast-tower\"></i> Monitoring Stations</h2>\r\n                    <div className=\"station-selector\">\r\n                        {isLoading ? <div className=\"loading-spinner small\"></div> : Object.entries(stations).map(([id, station]) => (\r\n                            <button key={id} className={`station-btn ${selectedStationId === id ? 'active' : ''}`} onClick={() => setSelectedStationId(id)}>\r\n                                <span className=\"station-name\">{station.station_info.name}</span>\r\n                                <span className=\"station-aqi\" style={{ backgroundColor: getAQIColor(station.highest_sub_index) }}>\r\n                                    {Math.round(station.highest_sub_index)}\r\n                                </span>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderDetailsPanelForDesktop = () => {\r\n        if (!selectedStationId) return null;\r\n        const station = stations[selectedStationId];\r\n        if (!station) return null;\r\n\r\n        return (\r\n            <div className=\"station-details-panel\">\r\n                <div className=\"station-details-content\">\r\n                    <div className=\"station-header\">\r\n                        <h3>{station.station_info.name}</h3>\r\n                    </div>\r\n                    {/* Simplified for brevity. Add forecast chart and readings here */}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"map-page\">\r\n            <nav className=\"navbar\">\r\n                <div className=\"navbar-content\">\r\n                    <Link to=\"/\" className=\"navbar-brand\">\r\n                        <img src={logoImage} alt=\"AQM Logo\" width={isMobile ? \"28\" : \"32\"} height={isMobile ? \"28\" : \"32\"} />\r\n                        <span>AirAware</span>\r\n                    </Link>\r\n                    <div className=\"nav-right\">\r\n                        {user ? (\r\n                            <div className=\"user-menu\">\r\n                                <Link to=\"/dashboard\" className=\"nav-link\">Dashboard</Link>\r\n                                <button onClick={logout} className=\"logout-btn\">Logout</button>\r\n                            </div>\r\n                        ) : (\r\n                            <Link to=\"/login\" className=\"login-btn\">Login</Link>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n            <div className=\"main-content\">\r\n                <div className=\"map-container\">\r\n                    <div id=\"map\" ref={mapRef} className=\"map-element\"></div>\r\n                    <button onClick={trackUserLocation} className={`my-location-btn ${isLocationLoading ? 'loading' : ''}`} disabled={isLocationLoading}>\r\n                        {isLocationLoading ? <div className=\"loading-spinner\"></div> : <i className=\"fas fa-crosshairs\"></i>}\r\n                    </button>\r\n                    {isMobile && (\r\n                        <button className=\"mobile-menu-toggle\" onClick={() => setIsPanelOpen(!isPanelOpen)}>\r\n                            <i className={`fas ${isPanelOpen ? 'fa-times' : 'fa-bars'}`}></i>\r\n                        </button>\r\n                    )}\r\n                </div>\r\n                \r\n                {!isMobile && renderPanelForDesktop()}\r\n                {!isMobile && renderDetailsPanelForDesktop()}\r\n\r\n                {isMobile && (\r\n                    <div className={`mobile-bottom-sheet ${isPanelOpen ? 'open' : ''}`}>\r\n                        <div className=\"mobile-tab-nav\">\r\n                            <button className={`mobile-tab-btn ${activeTab === 'user' ? 'active' : ''}`} onClick={() => setActiveTab('user')}>\r\n                                <i className=\"fas fa-user-circle\"></i> Your Location\r\n                            </button>\r\n                            <button className={`mobile-tab-btn ${activeTab === 'stations' ? 'active' : ''}`} onClick={() => setActiveTab('stations')}>\r\n                                <i className=\"fas fa-broadcast-tower\"></i> Stations\r\n                            </button>\r\n                            <button className={`mobile-tab-btn ${activeTab === 'forecast' ? 'active' : ''}`} onClick={() => setActiveTab('forecast')}>\r\n                                <i className=\"fas fa-chart-line\"></i> Forecast\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"mobile-tab-content-wrapper\">\r\n                            <div className=\"mobile-tab-content\">\r\n                                {activeTab === 'user' && renderUserContent()}\r\n                                {activeTab === 'stations' && renderStationContent()}\r\n                                {activeTab === 'forecast' && renderForecastContent()}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MapPage;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,EAAEC,WAAW,QAAQ,OAAO;AACvE,SAASC,IAAI,EAAEC,WAAW,QAAQ,kBAAkB;AACpD,OAAOC,SAAS,MAAM,oBAAoB;AAC1C,SAASC,OAAO,QAAQ,QAAQ;AAChC,OAAO,mBAAmB;AAC1B,SACEC,KAAK,IAAIC,OAAO,EAAEC,aAAa,EAAEC,WAAW,EAAEC,YAAY,EAAEC,WAAW,EAAEC,KAAK,EAAEC,OAAO,EAAEC,MAAM,EAAEC,MAAM,QAClG,UAAU;AACjB,SAASC,IAAI,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvCX,OAAO,CAACY,QAAQ,CAACX,aAAa,EAAEC,WAAW,EAAEC,YAAY,EAAEC,WAAW,EAAEC,KAAK,EAAEC,OAAO,EAAEC,MAAM,EAAEC,MAAM,CAAC;;AAEvG;AACA,MAAMK,WAAW,GAAIC,GAAG,IAAK;EACzB,IAAIA,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAKC,SAAS,EAAE,OAAO,SAAS;EACvD,IAAID,GAAG,IAAI,EAAE,EAAE,OAAO,SAAS;EAC/B,IAAIA,GAAG,IAAI,GAAG,EAAE,OAAO,SAAS;EAChC,IAAIA,GAAG,IAAI,GAAG,EAAE,OAAO,SAAS;EAChC,OAAO,SAAS;AACpB,CAAC;AAED,MAAME,YAAY,GAAIF,GAAG,IAAK;EAC1B,IAAIA,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAKC,SAAS,EAAE,OAAO,SAAS;EACvD,IAAID,GAAG,IAAI,EAAE,EAAE,OAAO,MAAM;EAC5B,IAAIA,GAAG,IAAI,GAAG,EAAE,OAAO,UAAU;EACjC,IAAIA,GAAG,IAAI,GAAG,EAAE,OAAO,WAAW;EAClC,OAAO,WAAW;AACtB,CAAC;AAED,MAAMG,iBAAiB,GAAGA,CAACC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,KAAK;EAClD,MAAMC,CAAC,GAAG,IAAI,CAAC,CAAC;EAChB,MAAMC,IAAI,GAAG,CAACH,IAAI,GAAGF,IAAI,IAAIM,IAAI,CAACC,EAAE,GAAG,GAAG;EAC1C,MAAMC,IAAI,GAAG,CAACL,IAAI,GAAGF,IAAI,IAAIK,IAAI,CAACC,EAAE,GAAG,GAAG;EAC1C,MAAME,CAAC,GAAGH,IAAI,CAACI,GAAG,CAACL,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,GAAGC,IAAI,CAACK,GAAG,CAACX,IAAI,GAAGM,IAAI,CAACC,EAAE,GAAG,GAAG,CAAC,GAAGD,IAAI,CAACK,GAAG,CAACT,IAAI,GAAGI,IAAI,CAACC,EAAE,GAAG,GAAG,CAAC,GAAGD,IAAI,CAACI,GAAG,CAACF,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC;EAC7H,MAAMI,CAAC,GAAG,CAAC,GAAGN,IAAI,CAACO,KAAK,CAACP,IAAI,CAACQ,IAAI,CAACL,CAAC,CAAC,EAAEH,IAAI,CAACQ,IAAI,CAAC,CAAC,GAAGL,CAAC,CAAC,CAAC;EACxD,OAAOL,CAAC,GAAGQ,CAAC;AAChB,CAAC;AAED,MAAMG,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAClB,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAG7C,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC8C,QAAQ,EAAEC,WAAW,CAAC,GAAG/C,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC5C,MAAM,CAACgD,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGjD,QAAQ,CAAC,IAAI,CAAC;EAChE,MAAM,CAACkD,SAAS,EAAEC,YAAY,CAAC,GAAGnD,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACoD,YAAY,EAAEC,eAAe,CAAC,GAAGrD,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACsD,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGvD,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAACwD,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGzD,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAAC0D,QAAQ,EAAEC,WAAW,CAAC,GAAG3D,QAAQ,CAAC4D,MAAM,CAACC,UAAU,IAAI,GAAG,CAAC;EAClE,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAG/D,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACgE,SAAS,EAAEC,YAAY,CAAC,GAAGjE,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;EACxD,MAAM,CAACkE,YAAY,EAAEC,eAAe,CAAC,GAAGnE,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACoE,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGrE,QAAQ,CAAC,KAAK,CAAC;EAEjE,MAAMsE,MAAM,GAAGpE,MAAM,CAAC,IAAI,CAAC;EAC3B,MAAMqE,UAAU,GAAGrE,MAAM,CAAC,CAAC,CAAC,CAAC;EAC7B,MAAMsE,qBAAqB,GAAGtE,MAAM,CAAC,IAAI,CAAC;EAC1C,MAAM;IAAEuE,IAAI;IAAEC;EAAO,CAAC,GAAGnE,OAAO,CAAC,CAAC;EAClC,MAAMoE,QAAQ,GAAGtE,WAAW,CAAC,CAAC;EAC9B,MAAMuE,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,GACpD,wCAAwC,GACxC,uBAAuB;;EAE7B;EACA;;EAEA9E,SAAS,CAAC,MAAM;IACZ,MAAM+E,YAAY,GAAGA,CAAA,KAAMrB,WAAW,CAACC,MAAM,CAACC,UAAU,IAAI,GAAG,CAAC;IAChED,MAAM,CAACqB,gBAAgB,CAAC,QAAQ,EAAED,YAAY,CAAC;IAC/C,OAAO,MAAMpB,MAAM,CAACsB,mBAAmB,CAAC,QAAQ,EAAEF,YAAY,CAAC;EACnE,CAAC,EAAE,EAAE,CAAC;EAEN/E,SAAS,CAAC,MAAM;IACZ,IAAIqE,MAAM,CAACa,OAAO,IAAI,CAACb,MAAM,CAACa,OAAO,CAACC,WAAW,EAAE;MAC/C,MAAMC,GAAG,GAAGzB,MAAM,CAAC0B,CAAC,CAACD,GAAG,CAACf,MAAM,CAACa,OAAO,EAAE;QAAEI,WAAW,EAAE;MAAM,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,EAAE,CAAC;MAC9F5B,MAAM,CAAC0B,CAAC,CAACG,SAAS,CAAC,oDAAoD,EAAE;QAAEC,WAAW,EAAE;MAAkB,CAAC,CAAC,CAACC,KAAK,CAACN,GAAG,CAAC;MACvHzB,MAAM,CAAC0B,CAAC,CAACM,OAAO,CAACC,IAAI,CAAC;QAAEC,QAAQ,EAAE;MAAW,CAAC,CAAC,CAACH,KAAK,CAACN,GAAG,CAAC;MAC1DxC,cAAc,CAACwC,GAAG,CAAC;IACvB;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMU,wBAAwB,GAAG5F,WAAW,CAAC,CAAC6F,YAAY,EAAEC,WAAW,KAAK;IACxE,MAAMC,YAAY,GAAGC,MAAM,CAACC,MAAM,CAACH,WAAW,CAAC,CAACI,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,QAAQ,CAAC;IACvE,IAAIL,YAAY,CAACM,MAAM,KAAK,CAAC,EAAE,OAAO;MAAEjF,GAAG,EAAE,CAAC;MAAE6E,MAAM,EAAE,CAAC;IAAE,CAAC;IAC5D,IAAIK,WAAW,GAAG,CAAC;MAAEC,WAAW,GAAG,CAAC;IACpC,MAAMC,cAAc,GAAG;MAAEC,IAAI,EAAE,CAAC;MAAEC,IAAI,EAAE,CAAC;MAAEC,GAAG,EAAE,CAAC;MAAEC,GAAG,EAAE,CAAC;MAAEC,EAAE,EAAE,CAAC;MAAEC,EAAE,EAAE,CAAC;MAAEC,GAAG,EAAE;IAAE,CAAC;IACjFhB,YAAY,CAACiB,OAAO,CAACC,OAAO,IAAI;MAC5B,MAAMC,QAAQ,GAAG3F,iBAAiB,CAACsE,YAAY,CAACsB,GAAG,EAAEtB,YAAY,CAACuB,GAAG,EAAEH,OAAO,CAACI,YAAY,CAACF,GAAG,EAAEF,OAAO,CAACI,YAAY,CAACD,GAAG,CAAC;MAC1H,MAAME,MAAM,GAAG,GAAG,GAAIxF,IAAI,CAACyF,GAAG,CAACL,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAE;MACrDZ,WAAW,IAAIgB,MAAM;MACrBtB,MAAM,CAACwB,IAAI,CAAChB,cAAc,CAAC,CAACQ,OAAO,CAACS,KAAK,IAAI;QAAA,IAAAC,iBAAA;QACzC,IAAI,EAAAA,iBAAA,GAAAT,OAAO,CAACb,QAAQ,cAAAsB,iBAAA,uBAAhBA,iBAAA,CAAmBD,KAAK,CAAC,MAAKpG,SAAS,EAAEmF,cAAc,CAACiB,KAAK,CAAC,IAAIR,OAAO,CAACb,QAAQ,CAACqB,KAAK,CAAC,GAAGH,MAAM;MAC1G,CAAC,CAAC;MACFf,WAAW,IAAI,CAACU,OAAO,CAACU,iBAAiB,IAAI,CAAC,IAAIL,MAAM;IAC5D,CAAC,CAAC;IACF,MAAMM,eAAe,GAAG,CAAC,CAAC;IAC1B5B,MAAM,CAACwB,IAAI,CAAChB,cAAc,CAAC,CAACQ,OAAO,CAACS,KAAK,IAAI;MACzCG,eAAe,CAACH,KAAK,CAAC,GAAGnB,WAAW,GAAG,CAAC,GAAGuB,UAAU,CAAC,CAACrB,cAAc,CAACiB,KAAK,CAAC,GAAGnB,WAAW,EAAEwB,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;IAC/G,CAAC,CAAC;IACF,MAAMC,YAAY,GAAGzB,WAAW,GAAG,CAAC,GAAGxE,IAAI,CAACkG,KAAK,CAACzB,WAAW,GAAGD,WAAW,CAAC,GAAG,EAAE;IACjF,OAAO;MAAEL,MAAM,EAAE2B,eAAe;MAAExG,GAAG,EAAE2G;IAAa,CAAC;EACzD,CAAC,EAAE,EAAE,CAAC;EAENjI,SAAS,CAAC,MAAM;IACZ,IAAImD,YAAY,IAAI+C,MAAM,CAACwB,IAAI,CAAC7E,QAAQ,CAAC,CAAC0D,MAAM,GAAG,CAAC,EAAE;MAClD,MAAM4B,UAAU,GAAGrC,wBAAwB,CAAC3C,YAAY,EAAEN,QAAQ,CAAC;MACnE,MAAM;QAAEwE,GAAG;QAAEC;MAAI,CAAC,GAAGzE,QAAQ,CAAC,SAAS,CAAC,CAAC0E,YAAY;MACrD,MAAMa,iBAAiB,GAAG3G,iBAAiB,CAAC0B,YAAY,CAACkE,GAAG,EAAElE,YAAY,CAACmE,GAAG,EAAED,GAAG,EAAEC,GAAG,CAAC;MACzFhE,mBAAmB,CAAC;QAChBhC,GAAG,EAAE6G,UAAU,CAAC7G,GAAG;QACnB6E,MAAM,EAAEgC,UAAU,CAAChC,MAAM;QACzBkC,OAAO,EAAED,iBAAiB,IAAI,GAAG,GAAG,eAAe,GAAG;MAC1D,CAAC,CAAC;IACN;EACJ,CAAC,EAAE,CAACjF,YAAY,EAAEN,QAAQ,EAAEiD,wBAAwB,CAAC,CAAC;EAEtD9F,SAAS,CAAC,MAAM;IACZ,MAAMsI,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC1BpF,YAAY,CAAC,IAAI,CAAC;MAClB,IAAI;QACA,MAAMqF,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAG7D,YAAY,oBAAoB,CAAC;QACjE,IAAI,CAAC4D,QAAQ,CAACE,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,6BAA6B,CAAC;QAChE,MAAMC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;QAClC9F,WAAW,CAAC6F,IAAI,CAAC9F,QAAQ,CAAC;MAC9B,CAAC,CAAC,OAAOgG,GAAG,EAAE;QACVC,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAEF,GAAG,CAAC;MACvD,CAAC,SAAS;QACN3F,YAAY,CAAC,KAAK,CAAC;MACvB;IACJ,CAAC;IACDoF,SAAS,CAAC,CAAC;IACX,MAAMU,QAAQ,GAAGC,WAAW,CAACX,SAAS,EAAE,KAAK,CAAC;IAC9C,OAAO,MAAMY,aAAa,CAACF,QAAQ,CAAC;EACxC,CAAC,EAAE,CAACrE,YAAY,CAAC,CAAC;EAElB3E,SAAS,CAAC,MAAM;IACZ,IAAI,CAAC+C,iBAAiB,EAAE;IACxB,MAAMoG,aAAa,GAAG,MAAAA,CAAA,KAAY;MAC9B/E,oBAAoB,CAAC,IAAI,CAAC;MAC1B,IAAI;QACA,MAAMmE,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAG7D,YAAY,gBAAgB5B,iBAAiB,YAAY,CAAC;QAC1F,MAAM4F,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;QAClC1E,eAAe,CAACyE,IAAI,CAACS,aAAa,IAAI,EAAE,CAAC;MAC7C,CAAC,CAAC,OAAOP,GAAG,EAAE;QACV3E,eAAe,CAAC,EAAE,CAAC;MACvB,CAAC,SAAS;QACNE,oBAAoB,CAAC,KAAK,CAAC;MAC/B;IACJ,CAAC;IACD+E,aAAa,CAAC,CAAC;EACnB,CAAC,EAAE,CAACpG,iBAAiB,EAAE4B,YAAY,CAAC,CAAC;EAErC3E,SAAS,CAAC,MAAM;IACZ,IAAI2C,WAAW,IAAIuD,MAAM,CAACwB,IAAI,CAAC7E,QAAQ,CAAC,CAAC0D,MAAM,GAAG,CAAC,EAAE;MACjDL,MAAM,CAACC,MAAM,CAAC7B,UAAU,CAACY,OAAO,CAAC,CAACgC,OAAO,CAACmC,MAAM,IAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC;MACpEhF,UAAU,CAACY,OAAO,GAAG,CAAC,CAAC;MACvBgB,MAAM,CAACqD,OAAO,CAAC1G,QAAQ,CAAC,CAACqE,OAAO,CAAC,CAAC,CAACsC,EAAE,EAAErC,OAAO,CAAC,KAAK;QAChD,MAAM;UAAEE,GAAG;UAAEC;QAAI,CAAC,GAAGH,OAAO,CAACI,YAAY;QACzC,MAAMkC,IAAI,GAAG9F,MAAM,CAAC0B,CAAC,CAACqE,OAAO,CAAC;UAC1BC,IAAI,EAAE,6DAA6DtI,WAAW,CAAC8F,OAAO,CAACU,iBAAiB,CAAC,WAAW;UACpH+B,SAAS,EAAE;QACf,CAAC,CAAC;QACF,MAAMP,MAAM,GAAG1F,MAAM,CAAC0B,CAAC,CAACgE,MAAM,CAAC,CAAChC,GAAG,EAAEC,GAAG,CAAC,EAAE;UAAEmC;QAAK,CAAC,CAAC,CAAC/D,KAAK,CAAC/C,WAAW,CAAC;QACvE0G,MAAM,CAACQ,EAAE,CAAC,OAAO,EAAE,MAAM;UACrB7G,oBAAoB,CAACwG,EAAE,CAAC;UACxB,IAAI/F,QAAQ,EAAE;YACVO,YAAY,CAAC,UAAU,CAAC;YACxBF,cAAc,CAAC,IAAI,CAAC;UACxB;QACJ,CAAC,CAAC;QACFQ,UAAU,CAACY,OAAO,CAACsE,EAAE,CAAC,GAAGH,MAAM;MACnC,CAAC,CAAC;IACN;EACJ,CAAC,EAAE,CAAC1G,WAAW,EAAEE,QAAQ,EAAEY,QAAQ,CAAC,CAAC;EAErCzD,SAAS,CAAC,MAAM;IACZ,IAAI2C,WAAW,IAAIQ,YAAY,EAAE;MAC7B,MAAM2G,QAAQ,GAAGnG,MAAM,CAAC0B,CAAC,CAACqE,OAAO,CAAC;QAC9BC,IAAI,EAAE,0CAA0C;QAChDC,SAAS,EAAE;MACf,CAAC,CAAC;MACF,IAAIrF,qBAAqB,CAACW,OAAO,EAAE;QAC/BX,qBAAqB,CAACW,OAAO,CAAC6E,SAAS,CAAC5G,YAAY,CAAC;MACzD,CAAC,MAAM;QACHoB,qBAAqB,CAACW,OAAO,GAAGvB,MAAM,CAAC0B,CAAC,CAACgE,MAAM,CAAClG,YAAY,EAAE;UAAEsG,IAAI,EAAEK;QAAS,CAAC,CAAC,CAACpE,KAAK,CAAC/C,WAAW,CAAC;MACxG;IACJ;EACJ,CAAC,EAAE,CAACA,WAAW,EAAEQ,YAAY,CAAC,CAAC;;EAE/B;EACA,MAAM6G,iBAAiB,GAAG9J,WAAW,CAAC,MAAM;IACxC,IAAIsE,IAAI,EAAE;MACN;MACAhB,oBAAoB,CAAC,IAAI,CAAC;MAC1ByG,SAAS,CAACC,WAAW,CAACC,kBAAkB,CACnCtE,QAAQ,IAAK;QACV,MAAMuE,GAAG,GAAG;UAAE/C,GAAG,EAAExB,QAAQ,CAACwE,MAAM,CAACC,QAAQ;UAAEhD,GAAG,EAAEzB,QAAQ,CAACwE,MAAM,CAACE;QAAU,CAAC;QAC7EnH,eAAe,CAACgH,GAAG,CAAC;QACpB5G,oBAAoB,CAAC,KAAK,CAAC;QAC3B,IAAIb,WAAW,EAAEA,WAAW,CAAC4C,OAAO,CAAC6E,GAAG,EAAE,EAAE,CAAC;QAC7C,IAAI3G,QAAQ,EAAE;UACVO,YAAY,CAAC,MAAM,CAAC;UACpBF,cAAc,CAAC,IAAI,CAAC;QACxB;MACJ,CAAC,EACD,MAAMN,oBAAoB,CAAC,KAAK,CAAC,EACjC;QAAEgH,kBAAkB,EAAE;MAAK,CAC/B,CAAC;IACL,CAAC,MAAM;MACH;MACA9F,QAAQ,CAAC,QAAQ,CAAC;IACtB;EACJ,CAAC,EAAE,CAAC/B,WAAW,EAAEc,QAAQ,EAAEe,IAAI,EAAEE,QAAQ,CAAC,CAAC;EAE3C,MAAM+F,iBAAiB,GAAGA,CAAA,KAAM;IAC5B,IAAI,CAACjG,IAAI,EAAE,oBACPrD,OAAA;MAAKyI,SAAS,EAAC,qBAAqB;MAAAc,QAAA,gBAChCvJ,OAAA;QAAGyI,SAAS,EAAC;MAAa;QAAAe,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC/B3J,OAAA;QAAAuJ,QAAA,EAAI;MAA2B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACpC3J,OAAA;QAAAuJ,QAAA,EAAG;MAAuE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAC9E3J,OAAA,CAAChB,IAAI;QAAC4K,EAAE,EAAC,QAAQ;QAACnB,SAAS,EAAC,kBAAkB;QAAAc,QAAA,gBAC1CvJ,OAAA;UAAGyI,SAAS,EAAC;QAAoB;UAAAe,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,kBAC1C;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;IAEV,IAAIvH,iBAAiB,EAAE,oBAAOpC,OAAA;MAAKyI,SAAS,EAAC,eAAe;MAAAc,QAAA,gBAACvJ,OAAA;QAAKyI,SAAS,EAAC;MAAiB;QAAAe,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAAA3J,OAAA;QAAAuJ,QAAA,EAAG;MAAwB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;IACzI,IAAI,CAACzH,gBAAgB,EAAE,oBACnBlC,OAAA;MAAKyI,SAAS,EAAC,wBAAwB;MAAAc,QAAA,gBACnCvJ,OAAA;QAAGyI,SAAS,EAAC;MAAuB;QAAAe,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACzC3J,OAAA;QAAAuJ,QAAA,EAAI;MAA2B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACpC3J,OAAA;QAAAuJ,QAAA,EAAG;MAA4D;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eACnE3J,OAAA;QAAQyI,SAAS,EAAC,qBAAqB;QAACoB,OAAO,EAAEhB,iBAAkB;QAAAU,QAAA,gBAC/DvJ,OAAA;UAAGyI,SAAS,EAAC;QAAmB;UAAAe,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,oBACzC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACR,CAAC;IAGV,oBACI3J,OAAA;MAAKyI,SAAS,EAAC,iBAAiB;MAAAc,QAAA,gBAC5BvJ,OAAA;QAAKyI,SAAS,EAAC,iBAAiB;QAACqB,KAAK,EAAE;UAAEC,UAAU,EAAE7J,WAAW,CAACgC,gBAAgB,CAAC/B,GAAG;QAAE,CAAE;QAAAoJ,QAAA,gBACtFvJ,OAAA;UAAKyI,SAAS,EAAC,YAAY;UAAAc,QAAA,EAAE1I,IAAI,CAACkG,KAAK,CAAC7E,gBAAgB,CAAC/B,GAAG;QAAC;UAAAqJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACpE3J,OAAA;UAAKyI,SAAS,EAAC,WAAW;UAAAc,QAAA,EAAElJ,YAAY,CAAC6B,gBAAgB,CAAC/B,GAAG;QAAC;UAAAqJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpE,CAAC,eACN3J,OAAA;QAAKyI,SAAS,EAAC,oBAAoB;QAAAc,QAAA,gBAC/BvJ,OAAA;UAAAuJ,QAAA,GAAKrH,gBAAgB,CAACgF,OAAO,EAAC,OAAK;QAAA;UAAAsC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACxC3J,OAAA;UAAAuJ,QAAA,EAAG;QAAqG;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3G,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAEd,CAAC;EAED,MAAMK,oBAAoB,GAAGA,CAAA,KAAM;IAC/B,IAAIlI,SAAS,EAAE,oBAAO9B,OAAA;MAAKyI,SAAS,EAAC,eAAe;MAAAc,QAAA,gBAACvJ,OAAA;QAAKyI,SAAS,EAAC;MAAiB;QAAAe,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAAA3J,OAAA;QAAAuJ,QAAA,EAAG;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;IAC5H,oBACI3J,OAAA;MAAKyI,SAAS,EAAC,qBAAqB;MAAAc,QAAA,EAC/BxE,MAAM,CAACqD,OAAO,CAAC1G,QAAQ,CAAC,CAACuC,GAAG,CAAC,CAAC,CAACoE,EAAE,EAAErC,OAAO,CAAC,kBACxChG,OAAA;QAAiByI,SAAS,EAAE,uBAAuB7G,iBAAiB,KAAKyG,EAAE,GAAG,QAAQ,GAAG,EAAE,EAAG;QAACwB,OAAO,EAAEA,CAAA,KAAM;UAAEhI,oBAAoB,CAACwG,EAAE,CAAC;UAAExF,YAAY,CAAC,UAAU,CAAC;QAAE,CAAE;QAAA0G,QAAA,gBAClKvJ,OAAA;UAAKyI,SAAS,EAAC,cAAc;UAAAc,QAAA,gBACzBvJ,OAAA;YAAAuJ,QAAA,EAAKvD,OAAO,CAACI,YAAY,CAAC6D;UAAI;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACpC3J,OAAA;YAAMyI,SAAS,EAAC,cAAc;YAAAc,QAAA,EAAC;UAAgB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrD,CAAC,eACN3J,OAAA;UAAKyI,SAAS,EAAC,mBAAmB;UAACqB,KAAK,EAAE;YAAEI,eAAe,EAAEhK,WAAW,CAAC8F,OAAO,CAACU,iBAAiB;UAAE,CAAE;UAAA6C,QAAA,gBAClGvJ,OAAA;YAAMyI,SAAS,EAAC,YAAY;YAAAc,QAAA,EAAE1I,IAAI,CAACkG,KAAK,CAACf,OAAO,CAACU,iBAAiB;UAAC;YAAA8C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC3E3J,OAAA;YAAMyI,SAAS,EAAC,YAAY;YAAAc,QAAA,EAAElJ,YAAY,CAAC2F,OAAO,CAACU,iBAAiB;UAAC;YAAA8C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5E,CAAC;MAAA,GARGtB,EAAE;QAAAmB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OASP,CACX;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CAAC;EAEd,CAAC;EAED,MAAMQ,qBAAqB,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA;IAChC,IAAI,CAACxI,iBAAiB,EAAE,oBACnB5B,OAAA;MAAKyI,SAAS,EAAC,qBAAqB;MAAAc,QAAA,gBACjCvJ,OAAA;QAAGyI,SAAS,EAAC;MAAmB;QAAAe,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACrC3J,OAAA;QAAAuJ,QAAA,EAAI;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC5B3J,OAAA;QAAAuJ,QAAA,EAAG;MAA2D;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eACjE3J,OAAA;QAAQyI,SAAS,EAAC,oBAAoB;QAACoB,OAAO,EAAEA,CAAA,KAAMhH,YAAY,CAAC,UAAU,CAAE;QAAA0G,QAAA,EAAC;MAAgB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzG,CAAC;IAEV,IAAI3G,iBAAiB,EAAE,oBAAOhD,OAAA;MAAKyI,SAAS,EAAC,eAAe;MAAAc,QAAA,gBAACvJ,OAAA;QAAKyI,SAAS,EAAC;MAAiB;QAAAe,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAAA3J,OAAA;QAAAuJ,QAAA,EAAG;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;IAEpI,MAAMU,SAAS,GAAG;MACdC,MAAM,EAAExH,YAAY,CAACmB,GAAG,CAACsG,CAAC,IAAI,IAAIC,IAAI,CAACD,CAAC,CAACE,GAAG,CAAC,CAACC,kBAAkB,CAAC,OAAO,EAAE;QAAEC,OAAO,EAAE;MAAQ,CAAC,CAAC,CAAC;MAChGC,QAAQ,EAAE,CAAC;QACPC,KAAK,EAAE,cAAc;QACrBrD,IAAI,EAAE1E,YAAY,CAACmB,GAAG,CAACsG,CAAC,IAAIA,CAAC,CAACO,QAAQ,CAAC;QACvCC,WAAW,EAAE,SAAS;QACtBb,eAAe,EAAE,yBAAyB;QAC1Cc,IAAI,EAAE,IAAI;QACVC,OAAO,EAAE;MACb,CAAC;IACL,CAAC;IAED,oBACIjL,OAAA;MAAKyI,SAAS,EAAC,yBAAyB;MAAAc,QAAA,gBACpCvJ,OAAA;QAAKyI,SAAS,EAAC,uBAAuB;QAAAc,QAAA,eAClCvJ,OAAA;UAAAuJ,QAAA,gBAAIvJ,OAAA;YAAGyI,SAAS,EAAC;UAAmB;YAAAe,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,KAAC,GAAAS,qBAAA,GAAC1I,QAAQ,CAACE,iBAAiB,CAAC,cAAAwI,qBAAA,uBAA3BA,qBAAA,CAA6BhE,YAAY,CAAC6D,IAAI;QAAA;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9F,CAAC,eACN3J,OAAA;QAAKyI,SAAS,EAAC,wBAAwB;QAAAc,QAAA,eACnCvJ,OAAA,CAACF,IAAI;UAAC0H,IAAI,EAAE6C,SAAU;UAACa,OAAO,EAAE;YAAEC,UAAU,EAAE,IAAI;YAAEC,mBAAmB,EAAE;UAAM;QAAE;UAAA5B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnF,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAEd,CAAC;EAED,MAAM0B,qBAAqB,GAAGA,CAAA,kBACzBrL,OAAA;IAAKyI,SAAS,EAAC,YAAY;IAAAc,QAAA,eACxBvJ,OAAA;MAAKyI,SAAS,EAAC,oBAAoB;MAAAc,QAAA,GAC9BD,iBAAiB,CAAC,CAAC,eACpBtJ,OAAA;QAAKyI,SAAS,EAAC,sBAAsB;QAAAc,QAAA,gBACjCvJ,OAAA;UAAIyI,SAAS,EAAC,eAAe;UAAAc,QAAA,gBAACvJ,OAAA;YAAGyI,SAAS,EAAC;UAAwB;YAAAe,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,wBAAoB;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACjG3J,OAAA;UAAKyI,SAAS,EAAC,kBAAkB;UAAAc,QAAA,EAC5BzH,SAAS,gBAAG9B,OAAA;YAAKyI,SAAS,EAAC;UAAuB;YAAAe,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,GAAG5E,MAAM,CAACqD,OAAO,CAAC1G,QAAQ,CAAC,CAACuC,GAAG,CAAC,CAAC,CAACoE,EAAE,EAAErC,OAAO,CAAC,kBACpGhG,OAAA;YAAiByI,SAAS,EAAE,eAAe7G,iBAAiB,KAAKyG,EAAE,GAAG,QAAQ,GAAG,EAAE,EAAG;YAACwB,OAAO,EAAEA,CAAA,KAAMhI,oBAAoB,CAACwG,EAAE,CAAE;YAAAkB,QAAA,gBAC3HvJ,OAAA;cAAMyI,SAAS,EAAC,cAAc;cAAAc,QAAA,EAAEvD,OAAO,CAACI,YAAY,CAAC6D;YAAI;cAAAT,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACjE3J,OAAA;cAAMyI,SAAS,EAAC,aAAa;cAACqB,KAAK,EAAE;gBAAEI,eAAe,EAAEhK,WAAW,CAAC8F,OAAO,CAACU,iBAAiB;cAAE,CAAE;cAAA6C,QAAA,EAC5F1I,IAAI,CAACkG,KAAK,CAACf,OAAO,CAACU,iBAAiB;YAAC;cAAA8C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpC,CAAC;UAAA,GAJEtB,EAAE;YAAAmB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAKP,CACX;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CACR;EAED,MAAM2B,4BAA4B,GAAGA,CAAA,KAAM;IACvC,IAAI,CAAC1J,iBAAiB,EAAE,OAAO,IAAI;IACnC,MAAMoE,OAAO,GAAGtE,QAAQ,CAACE,iBAAiB,CAAC;IAC3C,IAAI,CAACoE,OAAO,EAAE,OAAO,IAAI;IAEzB,oBACIhG,OAAA;MAAKyI,SAAS,EAAC,uBAAuB;MAAAc,QAAA,eAClCvJ,OAAA;QAAKyI,SAAS,EAAC,yBAAyB;QAAAc,QAAA,eACpCvJ,OAAA;UAAKyI,SAAS,EAAC,gBAAgB;UAAAc,QAAA,eAC3BvJ,OAAA;YAAAuJ,QAAA,EAAKvD,OAAO,CAACI,YAAY,CAAC6D;UAAI;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnC;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAEL;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAEd,CAAC;EAED,oBACI3J,OAAA;IAAKyI,SAAS,EAAC,UAAU;IAAAc,QAAA,gBACrBvJ,OAAA;MAAKyI,SAAS,EAAC,QAAQ;MAAAc,QAAA,eACnBvJ,OAAA;QAAKyI,SAAS,EAAC,gBAAgB;QAAAc,QAAA,gBAC3BvJ,OAAA,CAAChB,IAAI;UAAC4K,EAAE,EAAC,GAAG;UAACnB,SAAS,EAAC,cAAc;UAAAc,QAAA,gBACjCvJ,OAAA;YAAKuL,GAAG,EAAErM,SAAU;YAACsM,GAAG,EAAC,UAAU;YAACC,KAAK,EAAEnJ,QAAQ,GAAG,IAAI,GAAG,IAAK;YAACoJ,MAAM,EAAEpJ,QAAQ,GAAG,IAAI,GAAG;UAAK;YAAAkH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACrG3J,OAAA;YAAAuJ,QAAA,EAAM;UAAQ;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnB,CAAC,eACP3J,OAAA;UAAKyI,SAAS,EAAC,WAAW;UAAAc,QAAA,EACrBlG,IAAI,gBACDrD,OAAA;YAAKyI,SAAS,EAAC,WAAW;YAAAc,QAAA,gBACtBvJ,OAAA,CAAChB,IAAI;cAAC4K,EAAE,EAAC,YAAY;cAACnB,SAAS,EAAC,UAAU;cAAAc,QAAA,EAAC;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3D3J,OAAA;cAAQ6J,OAAO,EAAEvG,MAAO;cAACmF,SAAS,EAAC,YAAY;cAAAc,QAAA,EAAC;YAAM;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC9D,CAAC,gBAEN3J,OAAA,CAAChB,IAAI;YAAC4K,EAAE,EAAC,QAAQ;YAACnB,SAAS,EAAC,WAAW;YAAAc,QAAA,EAAC;UAAK;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM;QACtD;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,eACN3J,OAAA;MAAKyI,SAAS,EAAC,cAAc;MAAAc,QAAA,gBACzBvJ,OAAA;QAAKyI,SAAS,EAAC,eAAe;QAAAc,QAAA,gBAC1BvJ,OAAA;UAAKqI,EAAE,EAAC,KAAK;UAACsD,GAAG,EAAEzI,MAAO;UAACuF,SAAS,EAAC;QAAa;UAAAe,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACzD3J,OAAA;UAAQ6J,OAAO,EAAEhB,iBAAkB;UAACJ,SAAS,EAAE,mBAAmBrG,iBAAiB,GAAG,SAAS,GAAG,EAAE,EAAG;UAACwJ,QAAQ,EAAExJ,iBAAkB;UAAAmH,QAAA,EAC/HnH,iBAAiB,gBAAGpC,OAAA;YAAKyI,SAAS,EAAC;UAAiB;YAAAe,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,gBAAG3J,OAAA;YAAGyI,SAAS,EAAC;UAAmB;YAAAe,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChG,CAAC,EACRrH,QAAQ,iBACLtC,OAAA;UAAQyI,SAAS,EAAC,oBAAoB;UAACoB,OAAO,EAAEA,CAAA,KAAMlH,cAAc,CAAC,CAACD,WAAW,CAAE;UAAA6G,QAAA,eAC/EvJ,OAAA;YAAGyI,SAAS,EAAE,OAAO/F,WAAW,GAAG,UAAU,GAAG,SAAS;UAAG;YAAA8G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC7D,CACX;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,EAEL,CAACrH,QAAQ,IAAI+I,qBAAqB,CAAC,CAAC,EACpC,CAAC/I,QAAQ,IAAIgJ,4BAA4B,CAAC,CAAC,EAE3ChJ,QAAQ,iBACLtC,OAAA;QAAKyI,SAAS,EAAE,uBAAuB/F,WAAW,GAAG,MAAM,GAAG,EAAE,EAAG;QAAA6G,QAAA,gBAC/DvJ,OAAA;UAAKyI,SAAS,EAAC,gBAAgB;UAAAc,QAAA,gBAC3BvJ,OAAA;YAAQyI,SAAS,EAAE,kBAAkB7F,SAAS,KAAK,MAAM,GAAG,QAAQ,GAAG,EAAE,EAAG;YAACiH,OAAO,EAAEA,CAAA,KAAMhH,YAAY,CAAC,MAAM,CAAE;YAAA0G,QAAA,gBAC7GvJ,OAAA;cAAGyI,SAAS,EAAC;YAAoB;cAAAe,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,kBAC1C;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACT3J,OAAA;YAAQyI,SAAS,EAAE,kBAAkB7F,SAAS,KAAK,UAAU,GAAG,QAAQ,GAAG,EAAE,EAAG;YAACiH,OAAO,EAAEA,CAAA,KAAMhH,YAAY,CAAC,UAAU,CAAE;YAAA0G,QAAA,gBACrHvJ,OAAA;cAAGyI,SAAS,EAAC;YAAwB;cAAAe,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,aAC9C;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACT3J,OAAA;YAAQyI,SAAS,EAAE,kBAAkB7F,SAAS,KAAK,UAAU,GAAG,QAAQ,GAAG,EAAE,EAAG;YAACiH,OAAO,EAAEA,CAAA,KAAMhH,YAAY,CAAC,UAAU,CAAE;YAAA0G,QAAA,gBACrHvJ,OAAA;cAAGyI,SAAS,EAAC;YAAmB;cAAAe,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,aACzC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACR,CAAC,eACN3J,OAAA;UAAKyI,SAAS,EAAC,4BAA4B;UAAAc,QAAA,eACvCvJ,OAAA;YAAKyI,SAAS,EAAC,oBAAoB;YAAAc,QAAA,GAC9B3G,SAAS,KAAK,MAAM,IAAI0G,iBAAiB,CAAC,CAAC,EAC3C1G,SAAS,KAAK,UAAU,IAAIoH,oBAAoB,CAAC,CAAC,EAClDpH,SAAS,KAAK,UAAU,IAAIuH,qBAAqB,CAAC,CAAC;UAAA;YAAAX,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnD;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CACR;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd,CAAC;AAACpI,EAAA,CA7WID,OAAO;EAAA,QAiBgBnC,OAAO,EACfF,WAAW;AAAA;AAAA4M,EAAA,GAlB1BvK,OAAO;AA+Wb,eAAeA,OAAO;AAAC,IAAAuK,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}