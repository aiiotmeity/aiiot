{"ast":null,"code":"import React,{useState,useMemo}from'react';import{useNavigate}from'react-router-dom';import'./css/Signup.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Signup(){const[formData,setFormData]=useState({name:'',phone_number:''});const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState(false);const navigate=useNavigate();const API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:8000';// Memoize particles to prevent recreation on every render\nconst particles=useMemo(()=>{const particleElements=[];for(let i=0;i<30;i++){// Reduced from 50 to 30\nparticleElements.push(/*#__PURE__*/_jsx(\"div\",{className:\"particle\",style:{left:Math.random()*100+'%',top:Math.random()*100+'%',width:Math.random()*8+4+'px',height:Math.random()*8+4+'px',animationDelay:Math.random()*5+'s'}},i));}return particleElements;},[]);// Validate and format phone number\nconst validatePhoneNumber=phone=>{// Remove all non-digit characters except +\nconst cleanPhone=phone.replace(/[^\\d+]/g,'');// Check if it's a valid +91 format (13 characters: +91xxxxxxxxxx)\nif(cleanPhone.length===13&&cleanPhone.startsWith('+91')){const numberPart=cleanPhone.substring(3);// Remove +91\n// Check if the remaining 10 digits start with 6, 7, 8, or 9\nif(numberPart.length===10&&numberPart.match(/^[6-9]/)){return cleanPhone;// Return full +91xxxxxxxxxx format\n}}return null;};const handleChange=e=>{let value=e.target.value;// Special handling for phone number field\nif(e.target.name==='phone_number'){// Remove all non-digit characters except +\nvalue=value.replace(/[^\\d+]/g,'');// If user starts typing without +91, auto-add it\nif(value.length>0&&!value.startsWith('+91')){// If user typed only digits, prepend +91\nif(value.match(/^\\d/)){value='+91'+value;}}// Ensure it starts with +91\nif(!value.startsWith('+91')&&value.length>0){value='+91';}// Limit to exactly 13 characters (+91 + 10 digits)\nif(value.length>13){value=value.substring(0,13);}}setFormData({...formData,[e.target.name]:value});// Clear error when user types\nif(error){setError('');}};const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError('');try{// Validate name\nif(!formData.name.trim()){setError('Please enter your full name');setLoading(false);return;}if(formData.name.trim().length<2){setError('Name must be at least 2 characters long');setLoading(false);return;}// Validate phone number\nconst validatedPhone=validatePhoneNumber(formData.phone_number);if(!validatedPhone){setError('Please enter a valid phone number with +91 prefix (e.g., +919876543210)');setLoading(false);return;}console.log('Submitting signup with data:',{name:formData.name.trim(),phone_number:validatedPhone});const response=await fetch(`${API_BASE_URL}/api/signup/`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:formData.name.trim(),phone_number:validatedPhone})});const data=await response.json();console.log('Signup response:',data);if(response.ok&&data.success){setSuccess(true);setTimeout(()=>{navigate('/login');},2000);}else{setError(data.error||data.message||'Registration failed');}}catch(err){console.error('Signup error:',err);setError('Network error. Please try again.');}finally{setLoading(false);}};if(success){return/*#__PURE__*/_jsx(\"div\",{className:\"signup-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"success-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"success-animation\",children:/*#__PURE__*/_jsx(\"div\",{className:\"success-icon\",children:\"\\u2713\"})}),/*#__PURE__*/_jsx(\"h2\",{children:\"Registration Successful!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your account has been created successfully.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Redirecting to login page...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"loading-dots\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"signup-page\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"navbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"navbar-content\",children:/*#__PURE__*/_jsxs(\"a\",{href:\"/\",className:\"navbar-brand\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/aqi.webp\",alt:\"AQM Logo\"}),\"AirAware\"]})})}),/*#__PURE__*/_jsxs(\"section\",{className:\"signup-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"particles\",children:particles}),/*#__PURE__*/_jsxs(\"div\",{className:\"signup-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"signup-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-icon\",children:\"\\uD83D\\uDC64\"}),\" Sign Up\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Create your account to get started\"})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",style:{backgroundColor:'#f8d7da',color:'#721c24',padding:'12px',borderRadius:'4px',marginBottom:'16px',border:'1px solid #f5c6cb'},children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'8px'},children:\"\\u26A0\\uFE0F\"}),error]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"Full Name\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-icon\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC64\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",name:\"name\",value:formData.name,onChange:handleChange,placeholder:\"Enter your full name\",required:true,disabled:loading,style:{width:'100%',padding:'12px 12px 12px 45px',fontSize:'16px',border:'1px solid #ddd',borderRadius:'4px',outline:'none'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"phone_number\",children:\"Phone Number\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-icon\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCF1\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",id:\"phone_number\",name:\"phone_number\",value:formData.phone_number,onChange:handleChange,placeholder:\"+919876543210\",required:true,disabled:loading,maxLength:\"13\",style:{width:'100%',padding:'12px 12px 12px 45px',fontSize:'16px',border:'1px solid #ddd',borderRadius:'4px',outline:'none'}})]}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#666',fontSize:'14px'},children:\"Enter mobile number with +91 prefix (13 characters total)\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,style:{width:'100%',padding:'12px',fontSize:'16px',backgroundColor:loading?'#ccc':'#007bff',color:'white',border:'none',borderRadius:'4px',cursor:loading?'not-allowed':'pointer',marginTop:'16px'},children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'8px'},children:\"\\uD83D\\uDD04\"}),\" Creating Account...\"]}):'Create Account'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"signup-footer\",style:{marginTop:'24px',textAlign:'center'},children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Already have an account?\",/*#__PURE__*/_jsxs(\"a\",{href:\"/login\",style:{color:'#007bff',textDecoration:'none',marginLeft:'4px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{marginRight:'4px'},children:\"\\uD83D\\uDD11\"}),\" Login\"]})]})})]})]})]});}export default Signup;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}