{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arathy\\\\React_django\\\\my-django-react-app\\\\frontend\\\\src\\\\components\\\\MapPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Line } from 'react-chartjs-2';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler } from 'chart.js';\nimport { useAuth } from '../App';\nimport './css/MapPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler);\nconst getAQIColor = aqi => {\n  if (aqi === null || aqi === undefined) return '#6b7280';\n  if (aqi <= 50) return '#10b981';\n  if (aqi <= 100) return '#f59e0b';\n  if (aqi <= 200) return '#ef4444';\n  return '#7c2d12';\n};\nconst MapPage = () => {\n  _s();\n  const [mapInstance, setMapInstance] = useState(null);\n  const mapRef = useRef(null); // Ref for the map container DOM element\n  // ... other states and refs ...\n\n  // --- MAP INITIALIZATION WITH CLEANUP ---\n  useEffect(() => {\n    // Only run if the map container exists and a map is NOT already initialized\n    if (mapRef.current && !mapInstance) {\n      const L = window.L;\n      const map = L.map(mapRef.current).setView([10.176, 76.430], 14);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\n      setMapInstance(map);\n    }\n\n    // --- FIX: Cleanup function ---\n    // This runs when the component unmounts or before the effect re-runs in Strict Mode\n    return () => {\n      if (mapInstance) {\n        mapInstance.remove();\n        setMapInstance(null); // Clear the map instance from state\n      }\n    };\n  }, []); // Use an empty dependency array to run this effect only once on mount and unmount\n\n  // ... The rest of your component logic remains the same ...\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n      className: \"navbar\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"map\",\n          ref: mapRef,\n          className: \"map-element\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(MapPage, \"tFXg0RmdADknxJamitS5J910zw4=\");\n_c = MapPage;\nexport default MapPage;\nvar _c;\n$RefreshReg$(_c, \"MapPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Link","useNavigate","Line","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","Filler","useAuth","jsxDEV","_jsxDEV","register","getAQIColor","aqi","undefined","MapPage","_s","mapInstance","setMapInstance","mapRef","current","L","window","map","setView","tileLayer","addTo","remove","className","children","fileName","_jsxFileName","lineNumber","columnNumber","id","ref","_c","$RefreshReg$"],"sources":["C:/Users/arathy/React_django/my-django-react-app/frontend/src/components/MapPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { Line } from 'react-chartjs-2';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  Filler\r\n} from 'chart.js';\r\nimport { useAuth } from '../App';\r\nimport './css/MapPage.css';\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  Filler\r\n);\r\n\r\nconst getAQIColor = (aqi) => {\r\n  if (aqi === null || aqi === undefined) return '#6b7280';\r\n  if (aqi <= 50) return '#10b981';\r\n  if (aqi <= 100) return '#f59e0b';\r\n  if (aqi <= 200) return '#ef4444';\r\n  return '#7c2d12';\r\n};\r\n\r\nconst MapPage = () => {\r\n  const [mapInstance, setMapInstance] = useState(null);\r\n  const mapRef = useRef(null); // Ref for the map container DOM element\r\n  // ... other states and refs ...\r\n\r\n  // --- MAP INITIALIZATION WITH CLEANUP ---\r\n  useEffect(() => {\r\n    // Only run if the map container exists and a map is NOT already initialized\r\n    if (mapRef.current && !mapInstance) {\r\n      const L = window.L;\r\n      const map = L.map(mapRef.current).setView([10.176, 76.430], 14);\r\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\r\n      setMapInstance(map);\r\n    }\r\n\r\n    // --- FIX: Cleanup function ---\r\n    // This runs when the component unmounts or before the effect re-runs in Strict Mode\r\n    return () => {\r\n      if (mapInstance) {\r\n        mapInstance.remove();\r\n        setMapInstance(null); // Clear the map instance from state\r\n      }\r\n    };\r\n  }, []); // Use an empty dependency array to run this effect only once on mount and unmount\r\n\r\n  // ... The rest of your component logic remains the same ...\r\n\r\n  return (\r\n    <div className=\"map-page\">\r\n      <nav className=\"navbar\">{/* ... your navbar ... */}</nav>\r\n      <div className=\"main-content\">\r\n        <div className=\"map-container\">\r\n          <div id=\"map\" ref={mapRef} className=\"map-element\"></div>\r\n        </div>\r\n        {/* ... your details panel ... */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}